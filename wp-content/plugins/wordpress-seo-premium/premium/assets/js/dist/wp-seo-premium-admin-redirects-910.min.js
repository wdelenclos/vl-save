yoastPremiumWebpackJsonp([8],{1285:function(r,e,n){"use strict";!function(r){function e(){r("#wpseo_redirects_type").select2({width:"400px",language:wpseoSelect2Locale})}function n(){o=wp.template("redirects-inline-edit"),r.each(r(".redirect-table-tab"),function(e,n){r(n).wpseoRedirects(r(n).attr("id"))}),e()}var o,t=[410,451],u={ORIGIN:1,TARGET:2,TYPE:0},c={ENTER:13},i=function(r){this.form=r};i.prototype.getOriginField=function(){return this.form.find("input[name=wpseo_redirects_origin]")},i.prototype.getTargetField=function(){return this.form.find("input[name=wpseo_redirects_target]")},i.prototype.getTypeField=function(){return this.form.find("select[name=wpseo_redirects_type]")},i.prototype.clearErrorMessage=function(){this.form.find(".wpseo_redirect_form .form_error").remove()},i.prototype.setErrorMessage=function(r){this.form.find(".wpseo_redirect_form").prepend('<div class="form_error error"><p>'+r+"</p></div>")},i.prototype.removeRowHighlights=function(){this.form.find(".redirect_form_row").removeClass("field_error")},i.prototype.highLightRowErrors=function(r){for(var e=0;e<r.length;e++)switch(r[e]){case"origin":this.highlightRow(this.getOriginField());break;case"target":this.highlightRow(this.getTargetField());break;case"type":this.highlightRow(this.getTypeField())}},i.prototype.highlightRow=function(r){jQuery(r).closest("div.redirect_form_row").addClass("field_error")};var f=function(r,e){this.form=r,this.type=e,this.validationError=""};f.prototype.validate=function(){return this.form.clearErrorMessage(),this.form.removeRowHighlights(),!1!==this.runValidation(this.form.getOriginField(),this.form.getTargetField(),this.form.getTypeField())||(this.addValidationError(this.validationError),!1)},f.prototype.runValidation=function(r,e,n){if(""===r.val())return this.form.highlightRow(r),"plain"===this.type?this.setError(wpseoPremiumStrings.error_old_url):this.setError(wpseoPremiumStrings.error_regex);if(-1===jQuery.inArray(parseInt(n.val(),10),t)){if(""===e.val())return this.form.highlightRow(e),this.setError(wpseoPremiumStrings.error_new_url);if(e.val()===r.val())return this.form.highlightRow(e),this.setError(wpseoPremiumStrings.error_circular)}return""!==n.val()||(this.form.highlightRow(n),this.setError(wpseoPremiumStrings.error_new_type))},f.prototype.setError=function(r){return this.validationError=r,!1},f.prototype.addValidationError=function(r,e){this.form.setErrorMessage(r),void 0!==e&&this.form.highLightRowErrors(e)},f.prototype.getFormValues=function(){var r={origin:this.form.getOriginField().val().toString(),target:this.form.getTargetField().val().toString(),type:this.form.getTypeField().val().toString()};return jQuery.inArray(parseInt(r.type,10),t)>-1&&(r.target=""),r};var a=function(){this.row=null,this.quickEditRow=null};a.prototype.setup=function(e,n){this.row=e,this.quickEditRow=r(o({origin:_.unescape(n.origin.html()),target:_.unescape(n.target.html()),type:parseInt(n.type.html(),10),suffix:r("#the-list").find("tr").index(e)}))},a.prototype.getRow=function(){return this.row},a.prototype.getForm=function(){return this.quickEditRow},a.prototype.show=function(){this.row.addClass("hidden"),this.quickEditRow.insertAfter(this.row).show(400,function(){r(this).find(":input").first().focus()})},a.prototype.remove=function(){this.row.removeClass("hidden"),this.quickEditRow.remove()};var p=new a;r.widget("ui.dialog",r.ui.dialog,{_createOverlay:function(){this._super(),this.options.modal&&this._on(this.overlay,{click:function(r){this.close(r)}})}}),r.fn.wpseoRedirects=function(e){var n,o=this,a=e.replace("table-",""),l=!1,s=null,h=function(){l=!1,n=null};this.getButtons=function(e){return"default"===e?[{text:wpseoPremiumStrings.button_ok,click:function(){r(this).dialog("close")}}]:[{text:wpseoPremiumStrings.button_cancel,click:function(){h(),r(this).dialog("close")}},{text:wpseoPremiumStrings.button_save_anyway,class:"button-primary",click:function(){l=!0,n(),r(this).dialog("close"),h()}}]},this.rowCells=function(r){var e=r.find(".val");return{origin:e.eq(u.ORIGIN),target:e.eq(u.TARGET),type:e.eq(u.TYPE)}},this.dialog=function(e,n,o){void 0!==o&&"error"!==o||(o="default");var t=this.getButtons(o);r("#YoastRedirectDialogText").html(n),r("#YoastRedirectDialog").dialog({title:e,width:500,draggable:!1,resizable:!1,position:{at:"center center",my:"center center",of:window},buttons:t,modal:!0,close:function(){s.focus()}})},this.openDialog=function(r){this.dialog(r.title,r.message)},this.post=function(e,n){r.post(ajaxurl,e,n,"json")},this.editRow=function(e){if(r("#the-list").find("#inline-edit").length>0)return void this.dialog(wpseoPremiumStrings.edit_redirect,wpseoPremiumStrings.editing_redirect);p.setup(e,this.rowCells(e)),p.show(),new i(p.quickEditRow).getTypeField().trigger("change")},this.createRedirectRow=function(e,n,o,t){var u=["val"];return t.isTargetRelative&&""!==n&&"/"!==n||u.push("remove-slashes"),t.hasTrailingSlash&&u.push("has-trailing-slash"),r("<tr>").append(r("<th>").addClass("check-column").attr("scope","row").append(r("<input>").attr("name","wpseo_redirects_bulk_delete[]").attr("type","checkbox").val(_.escape(e)))).append(r("<td>").addClass("type column-type has-row-actions column-primary").append(r("<div>").addClass("val type").html(_.escape(o))).append(r("<div>").addClass("row-actions").append(r("<span>").addClass("edit").append(r("<a>").attr({href:"#",role:"button",class:"redirect-edit"}).html(wpseoPremiumStrings.editAction)).append(" | ")).append(r("<span>").addClass("trash").append(r("<a>").attr({href:"#",role:"button",class:"redirect-delete"}).html(wpseoPremiumStrings.deleteAction))))).append(r("<td>").addClass("column-old").append(r("<div>").addClass("val").html(_.escape(e)))).append(r("<td>").addClass("column-new").append(r("<div>").addClass(u.join(" ")).html(_.escape(n))))},this.handleError=function(r,e){r.addValidationError(e.message,e.fields),"warning"===e.type&&o.dialog(wpseoPremiumStrings.error_saving_redirect,e.message,e.type)},this.addRedirect=function(){var e=new i(r(".wpseo-new-redirect-form")),n=new f(e,a);if(!1===n.validate())return!1;var t=n.getFormValues();return o.post({action:"wpseo_add_redirect_"+a,ajax_nonce:r(".wpseo_redirects_ajax_nonce").val(),redirect:{origin:encodeURIComponent(t.origin),target:encodeURIComponent(t.target),type:t.type},ignore_warning:l},function(t){if(t.error)return o.handleError(n,t.error),!0;e.getOriginField().val(""),e.getTargetField().val(""),o.find(".no-items").remove();var u=o.createRedirectRow(t.origin,t.target,t.type,t.info);r("form#"+a).find("#the-list").prepend(u),o.openDialog(wpseoPremiumStrings.redirect_added)}),!0},this.updateRedirect=function(){var e=new i(p.getForm()),n=new f(e,a);if(!1===n.validate())return!1;var t=n.getFormValues(),u=p.getRow(),c=this.rowCells(u);return o.post({action:"wpseo_update_redirect_"+a,ajax_nonce:r(".wpseo_redirects_ajax_nonce").val(),old_redirect:{origin:encodeURIComponent(c.origin.html()),target:encodeURIComponent(c.target.html()),type:encodeURIComponent(c.type.html())},new_redirect:{origin:encodeURIComponent(t.origin),target:encodeURIComponent(t.target),type:encodeURIComponent(t.type)},ignore_warning:l},function(r){if(r.error)return o.handleError(n,r.error),!0;c.origin.html(_.escape(r.origin)),c.target.html(_.escape(r.target)),c.type.html(_.escape(r.type)),p.remove(),o.openDialog(wpseoPremiumStrings.redirect_updated)}),!0},this.deleteRedirect=function(e){var n=this.rowCells(e);o.post({action:"wpseo_delete_redirect_"+a,ajax_nonce:r(".wpseo_redirects_ajax_nonce").val(),redirect:{origin:encodeURIComponent(n.origin.html()),target:encodeURIComponent(n.target.html()),type:encodeURIComponent(n.type.html())}},function(){e.fadeTo("fast",0).slideUp(function(){r(this).remove()}),o.openDialog(wpseoPremiumStrings.redirect_deleted)})},this.setup=function(){var e;r("body").append('<div id="YoastRedirectDialog"><div id="YoastRedirectDialogText"></div></div>'),r(window).on("beforeunload",function(){if(r("#the-list").find("#inline-edit").length>0)return wpseoPremiumStrings.unsaved_redirects}),r(".redirect-table-tab").on("change","select[name=wpseo_redirects_type]",function(e){var n=parseInt(r(e.target).val(),10),o=r(e.target).closest(".wpseo_redirect_form").find(".wpseo_redirect_target_holder");jQuery.inArray(n,t)>-1?r(o).hide():r(o).show()}),r(".wpseo-new-redirect-form").on("click",".button-primary",function(){return n=function(){o.addRedirect()},o.addRedirect(),s=r(this),!1}).on("keypress","input",function(r){r.which===c.ENTER&&(n=function(){o.addRedirect()},r.preventDefault(),o.addRedirect())}),r(".wp-list-table").on("click",".redirect-edit",function(n){e=r(n.target).closest("tr"),n.preventDefault(),o.editRow(e),s=r(this)}).on("click",".redirect-delete",function(n){e=r(n.target).closest("tr"),n.preventDefault(),o.deleteRedirect(e),s=r("#cb-select-all-1")}).on("keypress","input",function(r){r.which===c.ENTER&&(n=function(){o.updateRedirect()},r.preventDefault(),o.updateRedirect())}).on("click",".save",function(){(n=function(){o.updateRedirect()})()}).on("click",".cancel",function(){n=null,p.remove(),e.find(".redirect-edit").focus()})},o.setup()},r(n)}(jQuery)}},[1285]);